<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>auth/login.html</title>
    <script type="text/javascript">
    window.onload=function() {
        let loginbtn = document.getElementById('login');
        loginbtn.addEventListener('click', login, false);
    }
    let xhr=null;
        function login() {
            let id = document.getElementById("id");
            let pwd = document.getElementById('pwd');
            let errMsg = document.getElementById('errMsg');
            errMsg.innerHTML="";
            let em="";
            let pty="";
            if (id.value==null || id.value.trim()=='') {
                em+="아이디";
                pty="를 입력하세요";
            }
            if (pwd.value==null || pwd.value.trim()=='') {
                if (em!="") {
                    em+="와 ";
                }
                em+="비밀번호";
                pty="를 입력하세요";
            }

            if (em!="" || pty!="") {
                errMsg.innerText=em+pty;
            }else {
                xhr = new XMLHttpRequest();
                xhr.onreadystatechange=function() {
                    if (xhr.readyState==4 && xhr.status==200) {
                        let json = JSON.parse(xhr.responseText);
                        // console.log(json.errMsg);
                        if (json.errMsg) {
                            errMsg.innerText=json.errMsg;
                        }
                        if (json.memid) {
                            location.href="/";
                        }
                    }
                }
                xhr.open('post', "../auth/login.do", true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                let param = "id="+id.value+"&pwd="+pwd.value;
                xhr.send(param);
            }
        }
    </script>
    <style type="text/css">
        
        #content{
            text-align: center;
            width:400px;
        }
        fieldset{
            padding:5px;
        }
        fieldset div input{
            /* border:0px; */
            width:100%;
            margin:5px;
        }
        #login{
            height:50px;
        }
        h1{text-align: center;}
        legend{
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="content">
        <h1>쇼핑몰</h1>
        <fieldset>
            <legend>로그인</legend>
            <div id="idrow">
                <input type="text" name="" id="id" placeholder="아이디">
            </div>
            <div id="pwdrow">
                <input type="password" name="" id="pwd" placeholder="비밀번호">
            </div>
            <div id="errMsg"></div>
            <input type="button" value="로그인" class="btn_01" id="login">
        </fieldset>
        <div id="member">
            <a href="../member/agree.html">회원가입</a>
            <a href="findId.html">아이디찾기</a>
            <a href="findPwd.html">비밀번호찾기</a>
        </div>
    </div>
</body>
</html>